<title>Admin</title>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="Robots" content="noindex,nofollow" />
<script type="text/javascript">
  //  FCKEditorPath = '<?php print_the_static_files_url() ; ?>js/fckeditor/';
    imgurl = '<?php print_the_static_files_url() ; ?>images/';
</script>
<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>admin/style.css" type="text/css" media="all"  />
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/tree/source/_lib.js"></script>-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.cookie.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.field.min.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.DOMWindow.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.form.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.fn.handleKeyboardChange.js"></script>

<!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/yuiloader/yuiloader-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/element/element-min.js"></script> 
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/uploader/uploader-min.js"></script> 
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>-->
<!-- Individual YUI CSS files -->
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/datatable/assets/skins/sam/datatable.css">
<!-- Individual YUI JS files -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/datasource/datasource-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/element/element-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/datatable/datatable-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.7.0/build/uploader/uploader.js"></script>






<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>jquery/jqgrid/css/ui.jqgrid.css" type="text/css" media="all"  />
<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>jquery/jqgrid/css/jquery.searchFilter.css" type="text/css" media="all"  />

<script type="text/javascript">
   var  jqgrid_dir = '<?php print_the_static_files_url() ; ?>jquery/jqgrid/js/';
    
</script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jqgrid/jqgrid_loader.js"></script>
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jqgrid/js/i18n/grid.locale-en.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jqgrid/jquery.jqGrid.js"></script>-->


<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/swfupload/swfupload.js"></script>-->
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/src/swfupload.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/src/swfupload.queue.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/src/swfupload.speed.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/src/handlers.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/src/jquery.swfupload.js"></script>
<script type="text/javascript">
   var  swfupload_flash_url = '<?php print_the_static_files_url() ; ?>js/swfupload/flash/swfupload.swf';
   var  swfupload_button_image_url = '<?php print_the_static_files_url() ; ?>jquery/swfupload-jquery-plugin/XPButtonUploadText_61x22.png';
</script>
 -->
    
    


<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.uploadify-v2.1.0/swfobject.js"></script>-->
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.uploadify-v2.1.0/jquery.uploadify.v2.1.0.min.js"></script>
<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>jquery/jquery.uploadify-v2.1.0/uploadify.css" type="text/css" />
<script type="text/javascript">
   var  uploadify_uploader_swf_url = '<?php print_the_static_files_url() ; ?>jquery/jquery.uploadify-v2.1.0/uploadify.swf';
   var  uploadify_cancel_image_url = '<?php print_the_static_files_url() ; ?>jquery/jquery.uploadify-v2.1.0/cancel.png';
</script>


-->
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/ui/js/jquery-ui-1.7.2.custom.min.js"></script>-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js"></script>

<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>js/ui/css/ui-lightness/jquery-ui-1.7.2.custom.css" type="text/css" />
<!--<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery.jmap.min-r72.js"></script>-->
<!--<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>jquery/jquery-treeview/jquery.treeview.css" type="text/css" />
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/jquery-treeview/jquery.treeview.js"></script>-->
<script type="text/javascript">
var tb_path = "<?php print_the_static_files_url() ; ?>jquery/thickbox/";
</script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>jquery/thickbox/thickbox.js"></script>
<link rel="stylesheet" href="<?php print_the_static_files_url() ; ?>jquery/thickbox/thickbox.css" type="text/css" media="all"  />
 
 
<?php if($load_google_map == true) : ?>
<!--<script src="http://www.google.com/jsapi?key=<?php print $this->core_model->optionsGetByKey ( 'google_maps_api_key' ); ?>" type="text/javascript"></script>-->
<script type="text/javascript">
//google.load("maps", "2");
</script>
<?php endif; ?>


 

<script type="text/javascript">
var filebrowserBrowserPath = '<?php print_the_static_files_url() ; ?>js/ckeditor/ckfinder/ckfinder/'
var filebrowserBrowserPathAndFilename = '<?php print_the_static_files_url() ; ?>js/ckeditor/ckfinder/ckfinder/'

</script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/ckeditor/ckeditor.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/ckeditor/ckfinder/ckfinder/ckfinder.js"></script>
<script type="text/javascript">
//CKEDITOR.replace( 'content_body' );
 

$(document).ready(function(){
						   
CKFinder.SetupCKEditor( null,  {     RememberLastFolder : true } );

CKEDITOR.replaceAll( 'richtext' );
CKEDITOR.replaceAll( 'content_body' );




});


</script>


 



<?php if($load_google_map == true) : ?>
<?php endif; ?>




<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/jquery.gritter.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/app.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/jquery.validate.js"></script>
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/sortable.js"></script>
<script type="text/javascript">

	$(document).ready(function(){

     //Context
    $.fn.extend({
           contextMenu:function(menu){
               return this.live("contextmenu", function(e){
                  var navtop = e.pageY;
                  var navleft = e.pageX;
                  $("#ooyesTreeContextMenu").html("");

                  //alert($("#bindContextNav").html())
                  $(this).find(".bindContextNav:first").clone(true).appendTo("#ooyesTreeContextMenu");
                  $(menu).css({"top":navtop, "left":navleft});
                  if($("#treeRenamer").length<=0){
                    $(menu).show();
                    $(this).addClass("ContextMenuActive");
                  }
                  var active_item = $(this);
                  $(".context").hover(function(){
                       $(this).addClass("contextHover")
                  }, function(){
                       $(this).removeClass("contextHover")
                  })
                        $(document).bind("click", function(){
                            if($(".contextHover").length<=0){
                    			$(menu).hide();
                                active_item.removeClass("ContextMenuActive");
                                $("#ooyesTreeContextMenu").empty();
                            }
                  	     });
                   return false;
               })
             }
         });
         // End Context



$('#loadingDiv')
    .hide()  // hide it initially
    .ajaxStart(function() {
        $(this).fadeIn();
    })
    .ajaxStop(function() {
        $(this).fadeOut();
    })
;
	})


$('#wrap').hide(); //Hide Content area when someone visit the page
$(document).ready(function(){
$('#loadingDiv').hide(); //hide loading are when page is ready for display
$('#wrap').show(); //Show the content area after page is ready
});




</script>
<link rel="stylesheet" type="text/css" href="<?php print_the_static_files_url() ; ?>js/tree/source/tree_component.css" />
<link rel="stylesheet" type="text/css" href="<?php print_the_static_files_url() ; ?>js/tree/source/themes/apple/style.css" />
<script type="text/javascript" src="<?php print_the_static_files_url() ; ?>js/tree/source/tree_component.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){



$(".ooyes_ul_tree_container li").contextMenu("#ooyesTreeContextMenu");
$(".ooyes_ul_pages_tree_container li").contextMenu("#ooyesTreeContextMenu");
recreate_js_category_trees();
recreate_js_pages_trees();
delete_category_pre_set_dialog();


          $(".treestate").live("click", function(e){
          if(e.button==0){
            if($(this).parent().hasClass("collapse")){
                  $(this).parent().find("ul:first").slideUp("fast");
                   $(this).removeClass("Activectrl");
                   $(this).parent().removeClass("collapse");
             }
             else{
                  $(this).parent().find("ul:first").slideDown('fast');
                  $(this).addClass('Activectrl');
                  $(this).parent().addClass('collapse');
             }
          }
          else if(e.button==2){return false}
          else{
                if($(this).parent().hasClass("collapse")){
                      $(this).parent().find("ul:first").slideUp('fast');
                       $(this).removeClass('Activectrl');
                       $(this).parent().removeClass('collapse');
                 }
                 else{
                      $(this).parent().find("ul:first").slideDown('fast');
                      $(this).addClass('Activectrl');
                      $(this).parent().addClass('collapse');
                 }
          }

        });


    })
	
	function recreate_js_category_trees_pre(obj, html){
	$(obj).html(html);
	}
	
	function recreate_js_category_trees(){
	   $(".ooyes_ul_tree_container").each(function(the_tree_index){
	   //tb_remove() ;
		$params =  $(this).attr("treeparams");
		//alert($params);
		$the_container = $(this);
		//$(this).html('loading...');
        $(this).attr("treeid", "tree_" + the_tree_index);
		//some icons
		$add_page_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/page_add.png' />";
		$add_page_url = "<?php print site_url('admin/content/posts_edit/id:0,category:'); ?>";

		
		
		
		$add_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__plus.png' />";
		$edit_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__pencil.png' />";
		$del_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__minus.png' />";
		$.post("<?php print site_url('ajax_helpers/taxonomy_categories_load_category_js_tree') ?>", { treeparams: $params, rand: Math.random() },
		  function(html){
		    var data = html;
                 var trees=document.getElementsByTagName('div');
                 the_tree_index=the_tree_index;
                 for(var tree=0; tree<trees.length; tree++){
                   var tattribute = trees[tree].getAttribute("treeid");
					   if(tattribute == "tree_" + the_tree_index){
						  var curr = tree;
						  document.getElementsByTagName('div')[curr].innerHTML = data;
                           $(".ooyes_ul_tree_container").addClass("LoadedUiTree")

                          $(".ooyes_ul_tree_container").eq(the_tree_index).find("a").each(function(){
							var tree_name = $(this).attr("name");
							$(this).after("<div class='bindContextNav'><a href='"+ $add_page_url + tree_name + "'>" + $add_page_icon + "Add post here</a> <a href='javascript:edit_category_dialog(0," + tree_name + ")'>" + $add_cat_icon + "Add sub-category</a>  <a href='javascript:edit_category_dialog(" + tree_name + ")'>" + $edit_cat_icon + "Edit category</a> <a href='javascript:delete_category_ajax(" + tree_name + ")'>" + $del_cat_icon + "Delete category</a></div>");
							
						  $(".ooyes_ul_tree_container li:has(li)").addClass("liparent collapse");
						  $(".ooyes_ul_tree_container li").not(":has(li)").addClass("lichild");
        $(".liparent").each(function(){
          if($(this).find(".treestate").length<=0){
             $(this).append("<span class='treestate Activectrl'></span>");
          }
          // alert($(this).html())
        })
        });

        $(".context").bind("contextmenu", function(){
          return false;
        });
       //  $(".ooyes_ul_tree_container li:has(li)").addClass("liparent collapse");
                   }
                 }
		  });

      });
	}

        tree = new Object;
        tree.hideall = function(id){
             $(id).find(".Activectrl").click();
        }
        tree.showall = function(id){
            $(id).find(".treestate").not(".Activectrl").click();
        }
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		function recreate_js_pages_trees(){
	   $(".ooyes_ul_pages_tree_container").each(function(the_tree_index){
	   //tb_remove() ;
		$params =  $(this).attr("treeparams");
		//alert($params);
		$the_container = $(this);
		//$(this).html('loading...');
        $(this).attr("treeid", "pages_tree_" + the_tree_index);
		//some icons
		$edit_page_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/page_edit.png' />";
		$edit_page_url = "<?php print site_url('admin/content/pages_edit/id:') ; ?>";
		
		$add_subpage_page_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/page_copy.png' />";
		$add_subpage_page_url = "<?php print site_url('admin/content/pages_edit/id:0/content_parent:') ; ?>";
		
		
		
		$add_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__plus.png' />";
		$edit_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__pencil.png' />";
		$del_cat_icon = "<img border='0' src='<?php print_the_static_files_url() ; ?>icons/folder__minus.png' />";
		
		
		
		$.post("<?php print site_url('ajax_helpers/pages_load_category_js_tree') ?>", { treeparams: $params, rand: Math.random() },
		  function(html){
		    var data = html;
                 var trees=document.getElementsByTagName('div');
                 the_tree_index=the_tree_index;
                 for(var tree=0; tree<trees.length; tree++){
                   var tattribute = trees[tree].getAttribute("treeid");
					   if(tattribute == "pages_tree_" + the_tree_index){
						  var curr = tree;
						  document.getElementsByTagName('div')[curr].innerHTML = data;
                          $(".ooyes_ul_pages_tree_container").addClass("LoadedUiTree")
                          $(".ooyes_ul_pages_tree_container").eq(the_tree_index).find("a").each(function(){
							var tree_name = $(this).attr("name");
							$(this).after("<div class='bindContextNav'>			<a href='"+$edit_page_url+tree_name+"'>" + $edit_page_icon + "Edit this page</a>	<a href='"+$add_subpage_page_url+tree_name+"'>" + $add_subpage_page_icon + "Add subpage</a>							</div>");
							
						  $(".ooyes_ul_pages_tree_container li:has(li)").addClass("liparent collapse");
                          $(".ooyes_ul_pages_tree_container li").not(":has(li)").addClass("lichild");
        $(".liparent").each(function(){
          if($(this).find(".treestate").length<=0){
             $(this).append("<span class='treestate Activectrl'></span>");
          }
          // alert($(this).html())
        })
        });

        $(".context").bind("contextmenu", function(){
          return false;
        });
       //  $(".ooyes_ul_tree_container li:has(li)").addClass("liparent collapse");
                   }
                 }
		  });

      });
	}
</script>
<script type="text/javascript">

function 	clear_cache_admin_link(){
$.post("<?php print site_url ('main/clearcache'); ?>", { name: "John", time: "2pm" },
  function(data){
    //alert("Data Loaded: " + data);
	$('#clear_cache_admin_link').fadeOut().fadeIn();

  });

  }


</script>
<script type="text/javascript">
    $(document).ready(function() { 
  //  $(".tablesorter").tablesorter(); 
   
});
</script>
<script type="text/javascript">
function deleteContentItem($id, $remove_element){
		
		var answer = confirm("Are you sure?")
	if (answer){
	$("#"+$remove_element).addClass("light_red_background");
		$.post("<?php print site_url('admin/content/content_delete/id:')  ?>"+$id, function(data){
						  //alert("Data Loaded: " + data);

						  if( $remove_element != false){
							  $("#"+$remove_element).fadeOut(); 
						  }
						  

						 
						});
	}
	else{
		return false;
	}
			
				
	}
	
	</script>
<div style="display:none;">
  <!--dialogs and ajax boxes are here-->
  <div id="deleteContentItem_dialog" title="Are you sure?" class="flora">
    <p>These items will be permanently deleted and cannot be recovered. Are you sure?</p>
  </div>
  <div id="deleteTaxonomyItem_dialog" title="Are you sure?" class="flora">
    <p>These items will be permanently deleted and cannot be recovered, also all the children items will inherit the parent of the deleted item. Are you sure?</p>
  </div>
</div>
<script type="text/javascript">
function edit_category_dialog($id, $parent){
$('#edit_categories_ajax_form_saved_status').hide();
$.post("<?php print site_url('admin/content/taxonomy_categories_edit_by_ajax/')  ?>" , { id: $id, parent_id: $parent },
  function(data){
   // alert("Data Loaded: " + data);
   $('.the_edit_categories_ajax_container').html(data);
   $(".the_edit_categories_ajax_container_accordion").accordion({
			fillSpace: true,
			autoHeight: true,
			collapsible: true,
			minHeight: 200,
			icons: {
    			header: "ui-icon-circle-arrow-e",
   				headerSelected: "ui-icon-circle-arrow-s"
			}
		});
    $.openDOMWindow({ 
        //loader:1, 
       // loaderImagePath:'animationProcessing.gif', 
        //loaderHeight:16, 
        //loaderWidth:17, 
		modal:false, 
        windowSourceID:'.the_edit_categories_ajax_container' 
    }); 
  });		
}

function edit_category_do_ajax_save($and_close){	

		var category_form_options = { 
		  //  target:        '#output2',   // target element(s) to be updated with server response 
		   // beforeSubmit:  showRequest,  // pre-submit callback 
		    url:       '<?php print site_url('admin/content/taxonomy_categories_edit_by_ajax/')  ?>',       // override for form's 'action' attribute 
        	type:      'post',        // 'get' or 'post', override for form's 'method' attribute 
			success:  function(data) { 
			   // $('#htmlExampleTarget').fadeIn('slow'); 
			   //alert(html);
			  // $('#edit_categories_ajax_form_saved_status').show();
			  if(data == 'new'){
			 	 $.closeDOMWindow({ 
						windowSourceID:'.the_edit_categories_ajax_container'
					}); 
			  } else {
						$('#edit_categories_ajax_form_saved_status').html('saved');
						$('#edit_categories_ajax_form_saved_status').html(data);
						$('#edit_categories_ajax_form_saved_status').fadeIn('slow'); 
						$('#edit_categories_ajax_form_saved_status').fadeOut('slow'); 
			  }
			  
			
			   
			   
			   recreate_js_category_trees();
			} 
		}; 
 
			$('#edit_categories_ajax_form').ajaxSubmit(category_form_options); 
			if($and_close == true){
				$.closeDOMWindow({ 
						windowSourceID:'.the_edit_categories_ajax_container' 
					}); 
					
			}
			
			$('#edit_categories_ajax_form').submit(function() { 
        return false; 
    }); 
			return false; 
}

function delete_category_pre_set_dialog(){


$("#the_delete_category_dialog_container").dialog({
			bgiframe: true,
			resizable: false,
			autoOpen: false ,
			height:140,
			modal: true,
			overlay: {
				backgroundColor: '#000',
				opacity: 0.5
			},
			buttons: {
				'Delete all items in recycle bin': function() {
					//$(this).dialog('close');
					//return true; 
					$to_del =  $("#the_delete_category_dialog_container_cat_id_to_delete").html();
					// alert($to_del);
					$.post("<?php print site_url('admin/content/taxonomy_categories_delete_by_ajax/')  ?>" , { id: $to_del },
					  function(data){
					// alert(data);
					  recreate_js_category_trees();
					  });	
					
					
					 $("#the_delete_category_dialog_container_cat_id_to_delete").html('');
					 $(this).dialog('close');
				},
				Cancel: function() {
				//return false; 
					//$(this).dialog('close');
					$("#the_delete_category_dialog_container_cat_id_to_delete").html('');
					$(this).dialog('close');
				}
			}
		});
}

function delete_category_ajax($id){
 $("#the_delete_category_dialog_container_cat_id_to_delete").html($id);
 $("#the_delete_category_dialog_container").dialog('open');
//alert($confirm);
}

</script>
<div id="create_new_content_choose_category_conpatiner" style="display:none"> Please select category to add content there.
            <?php $link = site_url('admin/content/posts_edit/id:0,category:'). '{id}';  
	  $link = "<a {active_code} href=$link name='{id}'>{taxonomy_value}</a>";
	 $tree_params = array();
	 $tree_params['content_parent'] = 0;
	 $tree_params['link'] = $link;
	 $tree_params['actve_ids'] = $content_selected_categories;
	 $tree_params['active_code'] = " class='active'  ";
	 $tree_params_string = $this->core_model->securityEncryptArray($tree_params);
	 ?>
            <div class="ooyes_ul_tree_container" treeparams='<?php print $tree_params_string;  ?>'></div>
            <?php $tree_params_string = false;  ?>
          </div>

